# CentOS 7 en una VM VirtualBox

[TOC]



## Instalación del Sistema Operativo

### Particionado de Disco

Todas primarias, ext4 o swap

- /boot 250Mb (Particion primaria, xfs)
- /swap 1Gb (LVM, xfs)
- / el resto (LVM, xfs)

Solo se creo el usuario root, se habilito la interfaz de red para inicio con el sistema y se publicó en el anfitrion el puerto ssh de la vm como 2222.

```xml
<?xml version="1.0"?>
<!--
** DO NOT EDIT THIS FILE.
** If you make changes to this file while any VirtualBox related application
** is running, your changes will be overwritten later, without taking effect.
** Use VBoxManage or the VirtualBox Manager GUI to make changes.
-->
<VirtualBox xmlns="http://www.virtualbox.org/" version="1.16-windows">
  <Machine uuid="{d8aa9a0d-10bb-478c-94c4-b22171cbe46d}" name="Centos7base" OSType="RedHat_64" snapshotFolder="Snapshots" lastStateChange="2017-12-27T13:30:20Z">
    <MediaRegistry>
      <HardDisks>
        <HardDisk uuid="{37aa5361-83d8-4067-9276-6cb2cd24c616}" location="Centos7base.vdi" format="VDI" type="Normal"/>
      </HardDisks>
      <DVDImages>
        <Image uuid="{becb0c86-25c5-4541-9e4a-1ce83ab708d1}" location="D:/VirtualMachines/CentOS-7-x86_64-Minimal-1611.iso"/>
      </DVDImages>
    </MediaRegistry>
    <Hardware>
      <CPU count="2">
        <PAE enabled="true"/>
        <LongMode enabled="true"/>
        <X2APIC enabled="true"/>
        <HardwareVirtExLargePages enabled="true"/>
      </CPU>
      <Memory RAMSize="1024"/>
      <Boot>
        <Order position="1" device="DVD"/>
        <Order position="2" device="HardDisk"/>
        <Order position="3" device="None"/>
        <Order position="4" device="None"/>
      </Boot>
      <Display VRAMSize="16"/>
      <VideoCapture fps="25" options="ac_enabled=false"/>
      <BIOS>
        <IOAPIC enabled="true"/>
      </BIOS>
      <USB>
        <Controllers>
          <Controller name="OHCI" type="OHCI"/>
        </Controllers>
      </USB>
      <Network>
        <Adapter slot="0" enabled="true" MACAddress="080027A64376" type="82540EM">
          <NAT>
            <Forwarding name="ssh" proto="1" hostport="2222" guestport="22"/>
          </NAT>
        </Adapter>
      </Network>
      <AudioAdapter codec="AD1980" driver="DirectSound" enabledIn="false"/>
      <RTC localOrUTC="UTC"/>
      <GuestProperties>
        <GuestProperty name="/VirtualBox/HostInfo/GUI/LanguageID" value="es_ES" timestamp="1514381420375026000" flags=""/>
      </GuestProperties>
    </Hardware>
    <StorageControllers>
      <StorageController name="IDE" type="PIIX4" PortCount="2" useHostIOCache="true" Bootable="true">
        <AttachedDevice passthrough="false" type="DVD" hotpluggable="false" port="1" device="0"/>
      </StorageController>
      <StorageController name="SATA" type="AHCI" PortCount="1" useHostIOCache="false" Bootable="true" IDE0MasterEmulationPort="0" IDE0SlaveEmulationPort="1" IDE1MasterEmulationPort="2" IDE1SlaveEmulationPort="3">
        <AttachedDevice type="HardDisk" hotpluggable="false" port="0" device="0">
          <Image uuid="{37aa5361-83d8-4067-9276-6cb2cd24c616}"/>
        </AttachedDevice>
      </StorageController>
    </StorageControllers>
  </Machine>
</VirtualBox>
```

## Primeras configuraciones en el sistema operativo

### Configurar el proxy en YUM

Ver en [yum](./yum.md) 

Luego de eso actualicé el sistema operativo

```bash
yum update
```

### Instalación de paquetes requisitos para virtualbox guest additions

Artículos base

https://wiki.centos.org/HowTos/Virtualization/VirtualBox/CentOSguest

https://wiki.centos.org/PackageManagement/Yum/Priorities

Pasos a seguir

```bash
yum --enablerepo=extras install epel-release
yum install dkms
yum groupinstall "Development Tools"
yum install kernel-devel kernel-headers
```

Montar la imagen ISO del CD de instalacion de las  "virtualbox guest addition"

```bash
mount -t iso9660 /dev/sr0 /mnt
```

Y para instalar debemos correr

```bash
 sh ./VBoxLinuxAdditions.run
Verifying archive integrity... All good.
Uncompressing VirtualBox 5.2.1 Guest Additions for Linux........
VirtualBox Guest Additions installer
Removing installed version 5.2.1 of VirtualBox Guest Additions...
Copying additional installer modules ...
Installing additional modules ...
VirtualBox Guest Additions: Building the VirtualBox Guest Additions kernel modules.
VirtualBox Guest Additions: Look at /var/log/vboxadd-setup.log to find out what went wrong
VirtualBox Guest Additions: Running kernel modules will not be replaced until the system is restarted
VirtualBox Guest Additions: Starting.
```

Con esto quedó una máquina base, que servirá como punto de partida.

